var _slicedToArray = function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { var _arr = []; for (var _iterator = arr[Symbol.iterator](), _step; !(_step = _iterator.next()).done;) { _arr.push(_step.value); if (i && _arr.length === i) break; } return _arr; } else { throw new TypeError("Invalid attempt to destructure non-iterable instance"); } };

var _toArray = function (arr) { return Array.isArray(arr) ? arr : Array.from(arr); };

document.addEventListener("DOMContentLoaded", init);

var zoom = 10;
var lastPPM = { width: 0, height: 0, pixels: [] };

function init() {
  var dropArea = window;

  // PreventDefault to prevent the browser from capturing the drop
  // event (and ask to save the PPM file or open it with the default
  // viewer).
  dropArea.addEventListener("dragenter", function (e) {
    e.preventDefault();
  });
  dropArea.addEventListener("dragover", function (e) {
    e.preventDefault();
  });
  dropArea.addEventListener("drop", function (e) {
    e.preventDefault();

    var file = e.dataTransfer.files[0];
    if (file == null) return error("No file was dropped");

    var reader = new FileReader();
    reader.onload = function () {
      lastPPM = parse(reader.result);
      display(lastPPM);
    };
    reader.onerror = error;
    reader.readAsText(file);
  });

  var $zoom = document.getElementById("zoom");
  $zoom.addEventListener("input", function (e) {
    zoom = $zoom.value;
    display(lastPPM);
  });

  // Get zoom value from DOM.  The browser can save the set value from
  // a previous session, so itâ€™s not always set to the default value.
  zoom = $zoom.value;
}

function error(e) {
  console.error(e);
}

// PPM String -> PPM object
function parse(ppmString) {
  // Remove lines comment lines beginning with '#', then rejoin.
  var lines = ppmString.split("\n").filter(function (l) {
    return !l.match(/^#/);
  }).join("\n");

  var whitespace = /[ \t\r\n]+/;
  var fields = lines.split(whitespace);

  var _fields = _toArray(fields);

  var magic = _fields[0];
  var width = _fields[1];
  var height = _fields[2];
  var maxVal = _fields[3];

  var pixelData = _fields.slice(4);

  if (magic !== "P3") return error("Expected 'P3' magic number at the beginning of the file, got " + magic);

  width = parseInt(width, 10);
  if (isNaN(width)) return error("Expected a decimal value for width, got " + width);

  height = parseInt(height, 10);
  if (isNaN(height)) return error("Expected a decimal value for height, got " + height);

  maxVal = parseInt(maxVal, 10);
  if (isNaN(maxVal) || maxVal < 0 || maxVal >= 65536) return error("Expected a positive decimal less than 65536 for maximum color value, got " + maxVal);

  var pixels = [];
  var idx, r, g, b;
  for (var y = 0; y < height; ++y) {
    for (var x = 0; x < width; ++x) {
      idx = 3 * (y * width + x);

      r = parseInt(pixelData[idx]);
      if (isNaN(r)) return error("Expected a decimal value for red component, got " + r);
      g = parseInt(pixelData[idx + 1]);
      if (isNaN(g)) return error("Expected a decimal value for green component, got " + g);
      b = parseInt(pixelData[idx + 2]);
      if (isNaN(b)) return error("Expected a decimal value for blue component, got " + b);

      pixels.push([r, g, b].map(function (p) {
        return p / maxVal;
      }));
    }
  }

  return { width: width, height: height, pixels: pixels };
}

// Display PPM object to canvas
function display(ppm) {
  var $canvas = document.getElementById("display");
  var c = $canvas.getContext("2d");
  $canvas.width = zoom * ppm.width;
  $canvas.height = zoom * ppm.height;
  c.scale(zoom, zoom);

  var idx, r, g, b;
  for (var y = 0; y < ppm.height; ++y) for (var x = 0; x < ppm.width; ++x) {
    idx = y * ppm.width + x;
    var _ref = ppm.pixels[idx].map(function (p) {
      return Math.floor(p * 255);
    });

    var _ref2 = _slicedToArray(_ref, 3);

    r = _ref2[0];
    g = _ref2[1];
    b = _ref2[2];

    c.fillStyle = "rgb(" + r + "," + g + "," + b + ")";
    c.fillRect(x, y, 1, 1);
  }
}

//# sourceMappingURL=data:application/json;base64,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QUMsQ0FBQyxHQUFHLENBQUMsVUFBQSxDQUFDO2FBQUksSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDLEdBQUcsR0FBRyxDQUFDO0tBQUEsQ0FBQzs7OztBQUF4RCxLQUFDO0FBQUUsS0FBQztBQUFFLEtBQUM7O0FBQ1QsS0FBQyxDQUFDLFNBQVMsWUFBVSxDQUFDLFNBQUksQ0FBQyxTQUFJLENBQUMsTUFBRyxDQUFBO0FBQ25DLEtBQUMsQ0FBQyxRQUFRLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUE7R0FDdkI7Q0FDSiIsImZpbGUiOiJ3ZWJwcG0uanMiLCJzb3VyY2VzQ29udGVudCI6WyJkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgaW5pdClcblxudmFyIHpvb20gPSAxMFxudmFyIGxhc3RQUE0gPSB7d2lkdGg6IDAsIGhlaWdodDogMCwgcGl4ZWxzOiBbXX1cblxuZnVuY3Rpb24gaW5pdCgpIHtcbiAgdmFyIGRyb3BBcmVhID0gd2luZG93XG5cbiAgLy8gUHJldmVudERlZmF1bHQgdG8gcHJldmVudCB0aGUgYnJvd3NlciBmcm9tIGNhcHR1cmluZyB0aGUgZHJvcFxuICAvLyBldmVudCAoYW5kIGFzayB0byBzYXZlIHRoZSBQUE0gZmlsZSBvciBvcGVuIGl0IHdpdGggdGhlIGRlZmF1bHRcbiAgLy8gdmlld2VyKS5cbiAgZHJvcEFyZWEuYWRkRXZlbnRMaXN0ZW5lcignZHJhZ2VudGVyJywgKGUpID0+IHtlLnByZXZlbnREZWZhdWx0KCl9KVxuICBkcm9wQXJlYS5hZGRFdmVudExpc3RlbmVyKCdkcmFnb3ZlcicsIChlKSA9PiB7ZS5wcmV2ZW50RGVmYXVsdCgpfSlcbiAgZHJvcEFyZWEuYWRkRXZlbnRMaXN0ZW5lcignZHJvcCcsIChlKSA9PiB7XG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpXG5cbiAgICB2YXIgZmlsZSA9IGUuZGF0YVRyYW5zZmVyLmZpbGVzWzBdXG4gICAgaWYgKGZpbGUgPT0gbnVsbCkgcmV0dXJuIGVycm9yKCdObyBmaWxlIHdhcyBkcm9wcGVkJylcblxuICAgIHZhciByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpXG4gICAgcmVhZGVyLm9ubG9hZCA9ICgpID0+IHtcbiAgICAgIGxhc3RQUE0gPSBwYXJzZShyZWFkZXIucmVzdWx0KVxuICAgICAgZGlzcGxheShsYXN0UFBNKVxuICAgIH1cbiAgICByZWFkZXIub25lcnJvciA9IGVycm9yXG4gICAgcmVhZGVyLnJlYWRBc1RleHQoZmlsZSlcbiAgfSlcblxuICB2YXIgJHpvb20gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnem9vbScpXG4gICR6b29tLmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgKGUpID0+IHtcbiAgICB6b29tID0gJHpvb20udmFsdWVcbiAgICBkaXNwbGF5KGxhc3RQUE0pXG4gIH0pXG5cbiAgLy8gR2V0IHpvb20gdmFsdWUgZnJvbSBET00uICBUaGUgYnJvd3NlciBjYW4gc2F2ZSB0aGUgc2V0IHZhbHVlIGZyb21cbiAgLy8gYSBwcmV2aW91cyBzZXNzaW9uLCBzbyBpdOKAmXMgbm90IGFsd2F5cyBzZXQgdG8gdGhlIGRlZmF1bHQgdmFsdWUuXG4gIHpvb20gPSAkem9vbS52YWx1ZVxufVxuXG5mdW5jdGlvbiBlcnJvcihlKSB7IGNvbnNvbGUuZXJyb3IoZSkgfVxuXG4vLyBQUE0gU3RyaW5nIC0+IFBQTSBvYmplY3RcbmZ1bmN0aW9uIHBhcnNlKHBwbVN0cmluZykge1xuICAvLyBSZW1vdmUgbGluZXMgY29tbWVudCBsaW5lcyBiZWdpbm5pbmcgd2l0aCAnIycsIHRoZW4gcmVqb2luLlxuICB2YXIgbGluZXMgPSBwcG1TdHJpbmcuc3BsaXQoJ1xcbicpXG4gICAgLmZpbHRlcihsID0+ICFsLm1hdGNoKC9eIy8pKVxuICAgIC5qb2luKCdcXG4nKVxuXG4gIHZhciB3aGl0ZXNwYWNlID0gL1sgXFx0XFxyXFxuXSsvXG4gIHZhciBmaWVsZHMgPSBsaW5lcy5zcGxpdCh3aGl0ZXNwYWNlKVxuXG4gIHZhciBbbWFnaWMsIHdpZHRoLCBoZWlnaHQsIG1heFZhbCwgLi4ucGl4ZWxEYXRhXSA9IGZpZWxkc1xuXG4gIGlmIChtYWdpYyAhPT0gJ1AzJylcbiAgICByZXR1cm4gZXJyb3IoYEV4cGVjdGVkICdQMycgbWFnaWMgbnVtYmVyIGF0IHRoZSBiZWdpbm5pbmcgb2YgdGhlIGZpbGUsIGdvdCAke21hZ2ljfWApXG5cbiAgd2lkdGggPSBwYXJzZUludCh3aWR0aCwgMTApXG4gIGlmIChpc05hTih3aWR0aCkpXG4gICAgcmV0dXJuIGVycm9yKGBFeHBlY3RlZCBhIGRlY2ltYWwgdmFsdWUgZm9yIHdpZHRoLCBnb3QgJHt3aWR0aH1gKVxuXG4gIGhlaWdodCA9IHBhcnNlSW50KGhlaWdodCwgMTApXG4gIGlmIChpc05hTihoZWlnaHQpKVxuICAgIHJldHVybiBlcnJvcihgRXhwZWN0ZWQgYSBkZWNpbWFsIHZhbHVlIGZvciBoZWlnaHQsIGdvdCAke2hlaWdodH1gKVxuXG4gIG1heFZhbCA9IHBhcnNlSW50KG1heFZhbCwgMTApXG4gIGlmIChpc05hTihtYXhWYWwpIHx8IG1heFZhbCA8IDAgfHwgbWF4VmFsID49IDY1NTM2KVxuICAgIHJldHVybiBlcnJvcihgRXhwZWN0ZWQgYSBwb3NpdGl2ZSBkZWNpbWFsIGxlc3MgdGhhbiA2NTUzNiBmb3IgbWF4aW11bSBjb2xvciB2YWx1ZSwgZ290ICR7bWF4VmFsfWApXG5cbiAgdmFyIHBpeGVscyA9IFtdXG4gIHZhciBpZHgsIHIsIGcsIGJcbiAgZm9yICh2YXIgeSA9IDA7IHkgPCBoZWlnaHQ7ICsreSkge1xuICAgIGZvciAodmFyIHggPSAwOyB4IDwgd2lkdGg7ICsreCkge1xuICAgICAgaWR4ID0gMyAqICh5ICogd2lkdGggKyB4KVxuXG4gICAgICByID0gcGFyc2VJbnQocGl4ZWxEYXRhW2lkeF0pXG4gICAgICBpZiAoaXNOYU4ocikpIHJldHVybiBlcnJvcihgRXhwZWN0ZWQgYSBkZWNpbWFsIHZhbHVlIGZvciByZWQgY29tcG9uZW50LCBnb3QgJHtyfWApXG4gICAgICBnID0gcGFyc2VJbnQocGl4ZWxEYXRhW2lkeCArIDFdKVxuICAgICAgaWYgKGlzTmFOKGcpKSByZXR1cm4gZXJyb3IoYEV4cGVjdGVkIGEgZGVjaW1hbCB2YWx1ZSBmb3IgZ3JlZW4gY29tcG9uZW50LCBnb3QgJHtnfWApXG4gICAgICBiID0gcGFyc2VJbnQocGl4ZWxEYXRhW2lkeCArIDJdKVxuICAgICAgaWYgKGlzTmFOKGIpKSByZXR1cm4gZXJyb3IoYEV4cGVjdGVkIGEgZGVjaW1hbCB2YWx1ZSBmb3IgYmx1ZSBjb21wb25lbnQsIGdvdCAke2J9YClcblxuICAgICAgcGl4ZWxzLnB1c2goW3IsZyxiXS5tYXAocCA9PiBwIC8gbWF4VmFsKSlcbiAgICB9XG4gIH1cblxuICByZXR1cm4ge3dpZHRoLCBoZWlnaHQsIHBpeGVsc31cbn1cblxuLy8gRGlzcGxheSBQUE0gb2JqZWN0IHRvIGNhbnZhc1xuZnVuY3Rpb24gZGlzcGxheShwcG0pIHtcbiAgdmFyICRjYW52YXMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZGlzcGxheScpXG4gIHZhciBjID0gJGNhbnZhcy5nZXRDb250ZXh0KCcyZCcpXG4gICRjYW52YXMud2lkdGggPSB6b29tICogcHBtLndpZHRoXG4gICRjYW52YXMuaGVpZ2h0ID0gem9vbSAqIHBwbS5oZWlnaHRcbiAgYy5zY2FsZSh6b29tLCB6b29tKVxuXG4gIHZhciBpZHgsIHIsIGcsIGJcbiAgZm9yICh2YXIgeSA9IDA7IHkgPCBwcG0uaGVpZ2h0OyArK3kpXG4gICAgZm9yICh2YXIgeCA9IDA7IHggPCBwcG0ud2lkdGg7ICsreCkge1xuICAgICAgaWR4ID0geSAqIHBwbS53aWR0aCArIHhcblxuICAgICAgO1tyLCBnLCBiXSA9IHBwbS5waXhlbHNbaWR4XS5tYXAocCA9PiBNYXRoLmZsb29yKHAgKiAyNTUpKVxuICAgICAgYy5maWxsU3R5bGUgPSBgcmdiKCR7cn0sJHtnfSwke2J9KWBcbiAgICAgIGMuZmlsbFJlY3QoeCwgeSwgMSwgMSlcbiAgICB9XG59XG4iXX0=